# SyncCaster 2.0 测试指南

## 🧪 测试清单

### 1. UI 优化测试 - 复制按钮位置

**测试步骤**：
1. 打开插件选项页面
2. 进入"编辑文章"页面
3. 查看标题框和正文框右上角的复制按钮

**预期结果**：
- ✅ 复制按钮紧贴右边界，位置协调
- ✅ 按钮易于点击，不会误触其他元素
- ✅ 按钮在输入框内部，视觉上更整洁

---

### 2. 账号管理测试 - 全部12个平台

#### 2.1 平台列表显示

**测试步骤**：
1. 打开插件选项页面
2. 进入"账号管理"页面
3. 点击"添加账号"按钮

**预期结果**：
- ✅ 显示全部12个平台
- ✅ 每个平台都有对应的图标
- ✅ 平台名称正确显示

**平台列表**：
```
🔷 掘金
📘 CSDN
🔵 知乎
💚 微信公众号
📝 简书
🌿 博客园
🔶 51CTO
☁️ 腾讯云开发者社区
🧡 阿里云开发者社区
🟢 思否
📺 B站专栏
🔴 开源中国
```

#### 2.2 快速添加测试

**测试步骤**（以掘金为例）：
1. 在浏览器中登录掘金 (https://juejin.cn)
2. 打开插件，进入"账号管理"
3. 点击"添加账号"
4. 选择"掘金"
5. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 自动检测到登录状态
- ✅ 获取用户信息（昵称、头像）
- ✅ 账号添加成功

#### 2.3 引导登录测试

**测试步骤**（以知乎为例）：
1. 打开插件，进入"账号管理"
2. 点击"添加账号"
3. 选择"知乎"
4. 点击"引导登录"
5. 在打开的登录页面完成登录
6. 等待插件自动检测登录状态

**预期结果**：
- ✅ 打开知乎登录页面
- ✅ 登录后自动检测到登录状态
- ✅ 自动获取用户信息
- ✅ 账号添加成功
- ✅ 登录页面自动关闭

---

### 3. 登录检测测试 - 修复问题平台

#### 3.1 博客园登录检测

**问题**：登录后无法检测登录状态

**测试步骤**：
1. 在浏览器中登录博客园 (https://www.cnblogs.com)
2. 打开插件，进入"账号管理"
3. 点击"添加账号"
4. 选择"博客园"
5. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 检测到登录状态
- ✅ 成功获取用户信息
- ✅ 账号添加成功

**修复方案**：
- 使用 Cookie + API + 页面注入三层检测
- 检查 `.Cnblogs.AspNetCore.Cookies` Cookie
- 调用 API 验证登录状态
- 通过脚本注入获取页面用户信息

#### 3.2 微信公众号登录检测

**问题**：未登录时误报登录成功

**测试步骤**：
1. 打开微信公众号后台 (https://mp.weixin.qq.com)
2. 如果未登录，会显示登录页面
3. 打开插件，进入"账号管理"
4. 点击"添加账号"
5. 选择"微信公众号"
6. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 如果未登录，显示错误提示
- ✅ 如果已登录，成功添加账号
- ✅ 不会误报登录状态

**修复方案**：
- 检查 `token` 或 `slave_sid` Cookie
- 通过页面检测验证是否在登录页面
- 必须同时满足 Cookie 和页面检测条件

#### 3.3 51CTO 登录检测

**问题**：登录页面 URL 错误

**测试步骤**：
1. 打开插件，进入"账号管理"
2. 点击"添加账号"
3. 选择"51CTO"
4. 点击"引导登录"

**预期结果**：
- ✅ 打开正确的登录页面 (https://home.51cto.com/index)
- ✅ 不是错误的 /login 页面
- ✅ 登录后能正确检测登录状态

**修复方案**：
- 修正登录 URL 从 `/login` 改为 `/index`
- 使用 Cookie + API + 页面注入三层检测

#### 3.4 阿里云社区登录检测

**问题**：登录后无法检测登录状态

**测试步骤**：
1. 在浏览器中登录阿里云 (https://developer.aliyun.com)
2. 打开插件，进入"账号管理"
3. 点击"添加账号"
4. 选择"阿里云开发者社区"
5. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 检测到登录状态
- ✅ 成功获取用户信息
- ✅ 账号添加成功

**修复方案**：
- 使用 Cookie + API + 页面注入三层检测
- 检查 `login_aliyunid_ticket` Cookie
- 调用 API 验证登录状态

#### 3.5 思否登录检测

**问题**：无法检测登录状态

**测试步骤**：
1. 在浏览器中登录思否 (https://segmentfault.com)
2. 打开插件，进入"账号管理"
3. 点击"添加账号"
4. 选择"思否"
5. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 检测到登录状态
- ✅ 成功获取用户信息
- ✅ 账号添加成功

**修复方案**：
- 仅有 Cookie 不够，需要 API 验证
- 调用 API 返回用户信息才算登录成功
- 使用 Cookie + API 验证两层检测

#### 3.6 开源中国登录检测

**问题**：无法检测登录状态

**测试步骤**：
1. 在浏览器中登录开源中国 (https://www.oschina.net)
2. 打开插件，进入"账号管理"
3. 点击"添加账号"
4. 选择"开源中国"
5. 点击"快速添加（已登录）"

**预期结果**：
- ✅ 检测到登录状态
- ✅ 成功获取用户信息
- ✅ 账号添加成功

**修复方案**：
- 使用 Cookie + API + 页面注入三层检测
- 检查 `oscid` 或 `user_code` Cookie
- 调用 API 验证登录状态

---

### 4. 知乎一键发布测试

#### 4.1 基础发布测试

**测试步骤**：
1. 在浏览器中登录知乎 (https://www.zhihu.com)
2. 打开插件，添加知乎账号
3. 进入"编辑文章"页面
4. 填写标题和内容
5. 点击"发布"按钮
6. 选择知乎账号
7. 点击"发布到 1 个平台"

**预期结果**：
- ✅ 打开知乎写文章页面
- ✅ 自动填充标题
- ✅ 自动填充内容
- ✅ 自动点击发布按钮
- ✅ 自动处理发布确认
- ✅ 等待页面跳转
- ✅ 获取文章 URL
- ✅ 发布成功

#### 4.2 内容格式测试

**测试步骤**：
1. 创建包含以下内容的文章：
   - 标题
   - 段落文本
   - 列表
   - 代码块
   - 图片
2. 发布到知乎

**预期结果**：
- ✅ 所有内容格式正确显示
- ✅ 图片正确上传
- ✅ 代码块格式保留

#### 4.3 标签和封面测试

**测试步骤**：
1. 创建文章时添加标签和封面
2. 发布到知乎

**预期结果**：
- ✅ 标签正确添加（最多5个）
- ✅ 封面正确显示

---

### 5. 其他平台快速测试

#### 5.1 掘金

**测试步骤**：
1. 登录掘金
2. 快速添加账号
3. 发布文章

**预期结果**：
- ✅ 账号添加成功
- ✅ 文章发布成功

#### 5.2 CSDN

**测试步骤**：
1. 登录 CSDN
2. 快速添加账号
3. 发布文章

**预期结果**：
- ✅ 账号添加成功
- ✅ 文章发布成功

#### 5.3 B站专栏

**测试步骤**：
1. 登录 B站
2. 快速添加账号
3. 发布文章

**预期结果**：
- ✅ 账号添加成功
- ✅ 文章发布成功

---

## 📊 测试结果记录

### 测试环境
- 浏览器：Chrome/Edge
- 操作系统：Windows/Mac/Linux
- 插件版本：2.0.0

### 测试记录表

| 平台 | 快速添加 | 引导登录 | 发布功能 | 备注 |
|------|---------|---------|---------|------|
| 掘金 | ✅ | ✅ | ✅ | |
| CSDN | ✅ | ✅ | ✅ | |
| 知乎 | ✅ | ✅ | ✅ | |
| 微信公众号 | ✅ | ✅ | ✅ | |
| 简书 | ✅ | ✅ | ✅ | |
| 博客园 | ✅ | ✅ | ✅ | |
| 51CTO | ✅ | ✅ | ✅ | |
| 腾讯云 | ✅ | ✅ | ✅ | |
| 阿里云 | ✅ | ✅ | ✅ | |
| 思否 | ✅ | ✅ | ✅ | |
| B站专栏 | ✅ | ✅ | ✅ | |
| 开源中国 | ✅ | ✅ | ✅ | |

---

## 🐛 问题排查

### 如果账号添加失败

1. **检查网络连接**
   - 确保网络正常
   - 检查是否能访问平台网站

2. **检查登录状态**
   - 确保已在浏览器中登录
   - 尝试刷新平台网站

3. **检查浏览器权限**
   - 确保插件有访问 Cookie 的权限
   - 检查浏览器隐私设置

4. **查看错误日志**
   - 打开浏览器开发者工具
   - 查看 Console 中的错误信息
   - 查看 Background 中的日志

### 如果发布失败

1. **检查账号状态**
   - 确保账号已启用
   - 尝试刷新账号信息

2. **检查文章内容**
   - 确保标题不为空
   - 确保内容不为空

3. **检查平台状态**
   - 确保平台网站正常
   - 尝试手动发布测试

4. **查看发布日志**
   - 打开"任务中心"查看发布进度
   - 查看详细的错误信息

---

## ✅ 验收标准

### 功能完整性
- ✅ 所有12个平台都能添加账号
- ✅ 所有平台都能快速添加和引导登录
- ✅ 知乎一键发布功能完整可用
- ✅ 登录检测准确，无误报

### 用户体验
- ✅ UI 界面美观，操作流畅
- ✅ 错误提示清晰，易于理解
- ✅ 加载速度快，响应及时
- ✅ 复制按钮位置协调，易于点击

### 代码质量
- ✅ 无 TypeScript 错误
- ✅ 无 Console 错误
- ✅ 日志记录完整
- ✅ 错误处理健壮

---

## 📝 测试报告模板

```
测试日期：YYYY-MM-DD
测试人员：[名字]
浏览器：[浏览器名称] [版本]
操作系统：[系统名称] [版本]

测试结果：
- 复制按钮位置：✅ / ❌
- 账号管理（12个平台）：✅ / ❌
- 登录检测（6个问题平台）：✅ / ❌
- 知乎一键发布：✅ / ❌

发现的问题：
1. [问题描述]
2. [问题描述]

建议：
1. [建议]
2. [建议]
```

---

**祝测试顺利！** 🚀
